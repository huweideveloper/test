webpackJsonp([74],{2132:function(e,t,n){(e.exports=n(704)(!1)).push([e.i,".createauditpro1 {\n  min-height: 837px;\n  background: #fff;\n  overflow: hidden;\n  position: relative;\n}\n.createauditpro1 .scroll {\n  padding: 20px 0;\n}\n.createauditpro1 .scroll .save {\n  position: absolute;\n  right: 40px;\n  padding: 0 20px;\n  height: 40px;\n  line-height: 40px;\n  background: #4c9fa9;\n  color: #fff;\n}\n.createauditpro1 .bigtitle {\n  padding: 20px;\n  font-size: 17px;\n}\n.createauditpro1 .title {\n  font-size: 16px;\n  height: 40px;\n  line-height: 40px;\n  padding-left: 66px;\n  margin-bottom: 20px;\n}\n.createauditpro1 .inputLine {\n  width: 80%;\n  position: relative;\n  margin: 10px 0;\n  display: inline-block;\n}\n.createauditpro1 .inputLine > span {\n  width: 100px;\n  text-align: right;\n}\n.createauditpro1 .inputLine input {\n  padding-left: 10px;\n  border-radius: 4px;\n  border: 1px solid #e8e8e8;\n  height: 40px;\n  line-height: 40px;\n}\n.createauditpro1 .inputLine textarea {\n  padding-left: 10px;\n  border-radius: 4px;\n  border: 1px solid #e8e8e8;\n  width: 80%;\n  height: 120px;\n  resize: none;\n}\n.createauditpro1 .w100 {\n  width: 100%;\n}\n.createauditpro1 .w100 input {\n  width: 80%;\n}\n.createauditpro1 .w100 span {\n  display: inline-block;\n  vertical-align: top;\n}\n.createauditpro1 .w135 {\n  width: 155px !important;\n  text-align: right;\n}\n.createauditpro1 .hangnei,\n.createauditpro1 .groupId {\n  display: inline-block;\n}\n.createauditpro1 .xlk {\n  height: 30px;\n  line-height: 30px;\n  width: 180px;\n}\n.createauditpro1 .uploadarea {\n  padding-left: 10px;\n  text-align: center;\n  height: 200px;\n  width: 80%;\n  border: 1px dashed #448e97;\n  margin: 20px 20px 20px 162px;\n  cursor: pointer;\n  border-radius: 5px;\n}\n.createauditpro1 .uploadarea img {\n  width: 95px;\n  height: 105px;\n  margin-top: 30px;\n  margin-bottom: 10px;\n}\n.createauditpro1 .uploadarea p:first-child {\n  margin-top: 105px;\n}\n.createauditpro1 .uploadarea .dianjiupload {\n  position: absolute;\n  top: 2000px;\n  left: 2000px;\n}\n.createauditpro1 .filelist {\n  width: 80%;\n  margin: 20px 0 50px 162px;\n}\n.createauditpro1 .filelist li {\n  width: 100%;\n  position: relative;\n  margin-bottom: 20px;\n  /* Standard syntax */\n}\n.createauditpro1 .filelist li i {\n  font-size: 24px;\n  color: #448e97;\n}\n.createauditpro1 .filelist li .filename {\n  vertical-align: top;\n}\n.createauditpro1 .filelist li .progress {\n  position: absolute;\n  top: 20px;\n  left: 27px;\n  height: 7px;\n  display: inline-block;\n  background: #448e97;\n  width: 90%;\n  border-radius: 8px;\n  -webkit-transition: width 0.8s ease;\n  -moz-transition: width 0.8s ease;\n  transition: width 0.8s ease;\n  -webkit-animation: progressbar 7s 1;\n  animation: progressbar 7s 1;\n}\n.createauditpro1 .filelist li .icon-guanbi {\n  position: absolute;\n  right: 10px;\n  font-size: 18px;\n  top: 7px;\n  cursor: pointer;\n}\n@-webkit-keyframes progressbar {\n  from {\n    width: 0;\n  }\n  to {\n    width: 90%;\n  }\n}\n@keyframes progress {\n  from {\n    width: 0;\n  }\n  to {\n    width: 90%;\n  }\n}\n.createauditpro1 .required1 {\n  width: unset !important;\n  color: red;\n  position: absolute;\n}\n",""])},318:function(e,t,n){"use strict";var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(r,i){try{var o=t[r](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}("next")})}}var i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Interstellar.pagesBase),a(t,[{key:"complete",value:function(){var e=this;this.app.header.openControl("auditproject"),this.app.header.changeselected(1),this.type=this.app.parpam.type,this.id=1*this.app.parpam.projectid,this.status=parseInt(this.app.parpam.status),this.styleModel(1),this.dropobj={},this.initProjectGroupSelect(),this.upload(),"new"!==this.type&&this.render();this.model._event._addEvent("apiData.change",function(){(e.dom.find(".proname").val()||e.dom.find("textarea").val())&&e.app.session.set("ischanged",!0),"{}"!=JSON.stringify(e.model.getData("apiData"))&&e.model.getData("apiData").name&&e.model.getData("apiData").remark?e.app.session.set("data_1",JSON.stringify(e.model.getData("apiData"))):e.app.session.del("data_1")}),this.eventAdd()}},{key:"initProjectGroupSelect",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=this,r=[{name:"groupId",className:"xlk",firstSelect:{val:"请选择一个项目群组",idx:""},input:!0,data:[{val:"",idx:""}]}],n.e(82).then(function(){var e=n(919);r.forEach(function(t,n){var r=a.app.loadModule(e,a.dom.find("."+t.name),{className:t.className,firstSelect:t.firstSelect,data:t.data,input:t.input});r.event._addEvent("option.click",function(e){a.model.apiData.groupId=e.idx}),r.event._addEvent("dropDown.clear",function(e){a.model.apiData.groupId=""}),r.event._addEvent("drop.input",function(e){a.queryProjectGroupList(e.data)}),a.dropobj[t.name]=r}),a.queryProjectGroupList()}.bind(null,n)).catch(n.oe);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"queryProjectGroupList",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var n,a,r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.queryProjectGroupList({name:t,page:1});case 2:if(n=e.sent,a=n.data,r=a.list.map(function(e){return{idx:e.id,val:e.name}}),this.dropobj.groupId.renderHtml(r),!t){e.next=8;break}return e.abrupt("return");case 8:setTimeout(function(){var e=i.model.getData("apiData");e.groupId&&i.dom.find('.groupId .option[data-idx="'+e.groupId+'"]').click()},20);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"eventAdd",value:function(){var e=this,t=this;this.dom.find(".uploadarea").on("click",function(){e.dom.find(".dianjiupload").click()}),this.dom.find(".dianjiupload").on("change",function(){var t=e.model.getData("apiData");t.remarkFileUrl=JSON.parse(t.remarkFileUrl),t.remarkFileUrl.push("http://video-static.xdcdn.xiaodutv.com/browse_static/v3/common/widget/global/player/newPlayer_e2332cd1.swf"),t.remarkFileUrl=JSON.stringify(t.remarkFileUrl),e.model.setData("apiData",t)}),this.dom.find(".apidata").on("change",function(){if(ES.selctorDoc(this).attr("api")){var e=ES.selctorDoc(this).attr("api"),n=t.model.getData("apiData");n[e]=JSON.stringify(ES.selctorDoc(this).val().trim()).slice(1,-1),t.model.setData("apiData",n)}}),this.dom.find(".proname").on("blur",function(){if("view"!==this.type){if(ES.selctorDoc(this).removeClass("redborder"),ES.selctorDoc(this).parent().find(".required1").remove(),ES.selctorDoc(this).parent().find(".required").remove(),ES.selctorDoc(this).val().trim()==this.proname)return;ES.selctorDoc(this).val().trim()}}),this.app.header.event._addEvent("header.changePageError",function(){e.dom.find(".redlabel").removeClass("redborder"),e.dom.find(".required").remove(),e.dom.find(".inputLine").dom.forEach(function(e,t){""!==Tool.checkForm(ES.selctorDoc(e).dom,"red")&&(e.find("."+e.attr("redlabel")).addClass("redborder"),e.find("."+e.attr("redlabel")).after('<span class="required">'+Tool.checkForm(ES.selctorDoc(e).dom,"red")+"</span>"))})}),this.dom.find(".save").on("click",r(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.dom.find(".redborder").removeClass("redborder"),e.dom.find(".required").remove(),e.dom.find(".inputLine:not(.justToJudge)").dom.forEach(function(){var t=r(regeneratorRuntime.mark(function t(n,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:""!==Tool.checkForm(ES.selctorDoc(n).dom,"red")&&(n.find("."+n.attr("redlabel")).addClass("redborder"),n.find("."+n.attr("redlabel")).after('<span class="required">'+Tool.checkForm(ES.selctorDoc(n).dom,"red")+"</span>"));case 1:case"end":return e.stop()}},t,e)}));return function(e,n){return t.apply(this,arguments)}}()),!e.dom.find(".redborder").dom||!e.dom.find(".redborder").dom.some(function(e){return 0!==e.box().clientHeight})){t.next=7;break}return t.abrupt("return",!1);case 7:return"new"==e.type?e.model.apiData.action=1:(e.model.apiData.action=2,e.model.apiData.auditProjectId=e.id),e.app.loading.show(),t.next=11,e.api.audit_project_edit(e.model.apiData);case 11:n=t.sent,e.app.loading.hide(),0==n.code?(e.app.session.clearAll(),e.app.changePage("createauditpro2",{type:"edit",projectid:n.data?n.data.auditProjectId:e.id,status:e.status})):e.errorshow(n.msg);case 14:case"end":return t.stop()}},t,e)})))}},{key:"errorshow",value:function(e){this.app.alert.show({title:" ",msg:e,close:!1})}},{key:"render",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},n={auditProjectId:this.id},this.app.loading.show(),e.next=5,this.api.auditproject_read(n);case 5:a=e.sent,this.app.loading.hide(),0==a.code?(t.name=a.data.name,t.remark=a.data.remark,t.groupId=a.data.groupId,t.remarkFileUrl=a.data.remarkFileUrl,t.description=a.data.description):this.errorshow(a.msg),this.proname=t.name,this.model.setData("apiData",t),this.dom.find(".apidata[api=name]").val(t.name),this.dom.find(".apidata[api=remark]").val(JSON.parse('"'+t.remark+'"')),this.dom.find(".apidata[api=description]").val(JSON.parse('"'+t.description+'"')),this.app.session.clearAll(),"view"==this.type&&(this.dom.find(".apidata").attr("readonly","readonly"),this.dom.find(".save").remove());case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=this,t=function(){var e;return function(){return e||(e=new FormData),e}}();FormData.prototype.deleteAll=function(){var e=this;this.forEach(function(t,n){e.delete(n)})};var n=document.getElementById("uploadarea");n.ondragover=function(e){e.preventDefault(),this.style.borderColor="red"},n.ondrop=function(n){e.style.borderColor="gray",n.preventDefault();var a,r,i,o=n.dataTransfer.files,s=o.length,p=0,d=document.createDocumentFragment(),l=t();for(l.entries();p<s;){a=document.createElement("tr"),i=Math.round(100*o[p].size/1024)/100+"KB",r=o[p].lastModifiedDate.toLocaleDateString()+" "+o[p].lastModifiedDate.toTimeString().split(" ")[0],a.innerHTML="<td>"+o[p].name+"</td><td>"+r+"</td><td>"+i+"</td><td>删除</td>";var c='<li class="file">\n                        <i class="iconfont icon-qubiezhen"></i>\n                        <span class="filename">'+o[p].name+'</span>\n                        <span class="progress"></span>                        <i class="iconfont icon-guanbi"></i>                    </li>';ES.selctorDoc(".filelist").append(c),d.appendChild(a),l.append(o[p].name,o[p]),p++}e.upload1(t)}}},{key:"upload1",value:function(e){var t=e();$.ajax({url:"upload",type:"POST",data:t,async:!0,cache:!1,contentType:!1,processData:!1,success:function(e){alert("succeed!"),closeModal(),e.deleteAll(),$(".tbody").empty()},error:function(e){alert("failed!")}})}},{key:"uploadufile",value:function(){var e=this.dom.find(".dianjiupload").val(),t=document.getElementById("uploader").files[0],n={file:t,fileRename:e};this.ufile.uploadFile(n,function(e){alert("上传成功");var n='<li class="file" linkurl="'+e+'">\n                        <i class="iconfont icon-qubiezhen"></i>\n                        <span class="filename">'+t.name+'</span>\n                        <span class="progress"></span>                        <i class="iconfont icon-guanbi"></i>                    </li>';ES.selctorDoc(".filelist").append(n)},function(e){console.error("errorCallBack",e)},function(e){})}}]),t}();e.exports=i},808:function(e,t,n){var a=n(2132);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(705)(a,r);a.locals&&(e.exports=a.locals)},809:function(e,t,n){"use strict";var a="/audit/project/edit",r="/audit/project/read",i="/group/search",o={audit_project_edit:function(e){return this.HttpRequest.POST(a,e)},auditproject_read:function(e){return this.HttpRequest.POST(r,e)},queryProjectGroupList:function(e){return this.HttpRequest.POST(i,e)}};e.exports=o},810:function(e,t){e.exports='<div class=createauditpro1> <div class=scroll> <a class="biaozhubtn save">保存</a> <p class=title>第一步：B端审核项目信息</p> <div class="inputLine w100" redlabel=inputBox> <span class=w135><label class=redstar>*</label>审核项目名称：</span> <input type=text class="inputBox apidata proname" check=empty api=name /> </div> <br/> <div class="inputLine w100" redlabel=inputBox> <span class=w135><label class=redstar>*</label>审核项目描述：</span> <textarea type=text class="inputBox apidata" check=empty api=remark></textarea> </div> <div class="inputLine w100 justToJudge" redlabel=xlk> <span class=w135>项目群组：</span> <div class=groupId check=empty></div> </div> <div class=uploadarea id=uploadarea> <img src=/images/page/shangchuan.png /> <p>可以上传图片、视频文件等规范外部医生标注</p> <input type=file class=dianjiupload id=uploader /> </div> <ul class=filelist></ul> <div class="inputLine w100" redlabel=inputBox> <span class=w135>审核项目备注：</span> <textarea type=text class="inputBox apidata" check="" api=description></textarea> </div> </div> </div> '},811:function(e,t,n){"use strict";var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.listInfo={},n.hospitalInfo={},n.modalityInfo={},n.totalInfo={},n.componentdata={},n.apiData={name:"",remark:"",remarkFileUrl:"[]",description:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Interstellar.modelBase),t}();e.exports=a}});