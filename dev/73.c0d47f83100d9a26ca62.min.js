webpackJsonp([73],{2144:function(t,e,a){(t.exports=a(704)(!1)).push([t.i,".createaudittask1 {\n  min-height: 837px;\n  background: #fff;\n  overflow: hidden;\n  position: relative;\n}\n.createaudittask1 > .scroll {\n  overflow: hidden;\n  padding: 20px 0;\n}\n.createaudittask1 > .scroll .save {\n  position: absolute;\n  right: 40px;\n  padding: 0 20px;\n  height: 40px;\n  line-height: 40px;\n  background: #4c9fa9;\n  color: #fff;\n}\n.createaudittask1 .bigtitle {\n  padding: 20px;\n  font-size: 17px;\n}\n.createaudittask1 .title {\n  font-size: 16px;\n  height: 40px;\n  line-height: 40px;\n  padding-left: 66px;\n  margin-bottom: 20px;\n}\n.createaudittask1 .inputLine {\n  width: 80%;\n  position: relative;\n  margin: 10px 0;\n  display: inline-block;\n}\n.createaudittask1 .inputLine > span {\n  width: 100px;\n  text-align: right;\n}\n.createaudittask1 .inputLine > input {\n  padding-left: 10px;\n  border-radius: 4px;\n  border: 1px solid #e8e8e8;\n  height: 40px;\n  line-height: 40px;\n}\n.createaudittask1 .inputLine textarea {\n  padding-left: 10px;\n  border-radius: 4px;\n  border: 1px solid #e8e8e8;\n  width: 80%;\n  height: 120px;\n  resize: none;\n}\n.createaudittask1 .inputLine .project {\n  display: inline-block;\n  width: 80%;\n}\n.createaudittask1 .inputLine .project .xlk {\n  height: 40px;\n  line-height: 40px;\n  width: 100%;\n}\n.createaudittask1 .w100 {\n  width: 100%;\n}\n.createaudittask1 .w100 input {\n  width: 80%;\n}\n.createaudittask1 .w100 span {\n  display: inline-block;\n  vertical-align: top;\n}\n.createaudittask1 .w50 {\n  width: 40%;\n  display: inline-block;\n}\n.createaudittask1 .w50 input {\n  width: 50%;\n}\n.createaudittask1 .w50 span {\n  display: inline-block;\n  vertical-align: top;\n}\n.createaudittask1 .w50 .project {\n  width: 50%;\n}\n.createaudittask1 .w50 .project .nowname {\n  width: 92%;\n}\n.createaudittask1 .w135 {\n  width: 155px !important;\n  text-align: right;\n}\n.createaudittask1 .hangnei {\n  display: inline-block;\n}\n.createaudittask1 .uploadarea {\n  padding-left: 10px;\n  text-align: center;\n  height: 200px;\n  width: 80%;\n  border: 1px dashed #448e97;\n  margin: 20px 20px 20px 162px;\n  cursor: pointer;\n  border-radius: 5px;\n}\n.createaudittask1 .uploadarea img {\n  width: 95px;\n  height: 105px;\n  margin-top: 30px;\n  margin-bottom: 10px;\n}\n.createaudittask1 .uploadarea p:first-child {\n  margin-top: 105px;\n}\n.createaudittask1 .uploadarea .dianjiupload {\n  position: absolute;\n  top: 2000px;\n  left: 2000px;\n}\n.createaudittask1 .filelist {\n  width: 80%;\n  margin: 20px 0 50px 162px;\n}\n.createaudittask1 .filelist li {\n  width: 100%;\n  position: relative;\n  margin-bottom: 20px;\n  /* Standard syntax */\n}\n.createaudittask1 .filelist li i {\n  font-size: 24px;\n  color: #448e97;\n}\n.createaudittask1 .filelist li .filename {\n  vertical-align: top;\n}\n.createaudittask1 .filelist li .progress {\n  position: absolute;\n  top: 20px;\n  left: 27px;\n  height: 7px;\n  display: inline-block;\n  background: #448e97;\n  width: 90%;\n  border-radius: 8px;\n  -webkit-transition: width 0.8s ease;\n  -moz-transition: width 0.8s ease;\n  transition: width 0.8s ease;\n  -webkit-animation: progressbar 7s 1;\n  animation: progressbar 7s 1;\n}\n.createaudittask1 .filelist li .icon-guanbi {\n  position: absolute;\n  right: 10px;\n  font-size: 18px;\n  top: 7px;\n  cursor: pointer;\n}\n@-webkit-keyframes progressbar {\n  from {\n    width: 0;\n  }\n  to {\n    width: 90%;\n  }\n}\n@keyframes progress {\n  from {\n    width: 0;\n  }\n  to {\n    width: 90%;\n  }\n}\n.createaudittask1 .required1 {\n  width: unset !important;\n  color: red;\n  position: absolute;\n}\n",""])},323:function(t,e,a){"use strict";var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();function i(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,a){return function n(i,r){try{var o=e[i](r),s=o.value}catch(t){return void a(t)}if(!o.done)return Promise.resolve(s).then(function(t){n("next",t)},function(t){n("throw",t)});t(s)}("next")})}}var r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Interstellar.pagesBase),n(e,[{key:"complete",value:function(){var t=this;this.app.header.openControl("audittask"),this.app.header.changeselected(1),this.type=this.app.parpam.type,this.taskid=1*this.app.parpam.taskid,this.projectid=1*this.app.parpam.projectid,this.status=parseInt(this.app.parpam.status),this.styleModel(1),this.upload(),this.loadModule();"view"==this.type&&this.dom.find(".save").remove(),this.model._event._addEvent("apiData.change",function(){t.app.session.set("ischanged",!0),"{}"!=JSON.stringify(t.model.getData("apiData"))&&t.model.getData("apiData").name&&t.model.getData("apiData").projectId?t.app.session.set("data_1",JSON.stringify(t.model.getData("apiData"))):t.app.session.del("data_1")}),this.eventAdd()}},{key:"loadModule",value:function(){var t=this;a.e(82).then(function(){var e=a(919);t.project=t.app.loadModule(e,t.dom.find(".project"),{className:"xlk",firstSelect:{val:"请选择审核项目",idx:""},input:!0,data:[]}),t.project.event._addEvent("option.click",function(e){t.model.apiData.projectId=parseInt(e.idx),t.app.session.set("ischanged",!0)}),t.project.event._addEvent("dropDown.clear",function(e){t.model.apiData.projectId="",t.audit_project_search("")}),t.project.event._addEvent("drop.input",function(e){t.audit_project_search(e.data)}),t.audit_project_search("",!0)}.bind(null,a)).catch(a.oe)}},{key:"audit_project_search",value:function(){var t=i(regeneratorRuntime.mark(function t(e,a){var n,i,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={},e&&(n.auditProjectName=e),this.project.loading(!0),t.next=5,this.api.audit_project_name_search(n);case 5:i=t.sent,this.project.loading(!1),0==i.code?(this.projectlist=[],i.data.list.forEach(function(t,e){var a={};a.idx=t.auditProjectId,a.val=t.auditProjectName,r.projectlist.push(a)}),this.project.renderHtml(this.projectlist)):this.errorshow(i.msg),"new"!==this.type&&a&&this.render();case 9:case"end":return t.stop()}},t,this)}));return function(e,a){return t.apply(this,arguments)}}()},{key:"eventAdd",value:function(){var t=this,e=this;this.dom.find(".uploadarea").on("click",function(){t.dom.find(".dianjiupload").click()}),this.dom.find(".dianjiupload").on("change",function(){var e=t.model.getData("apiData");e.remarkFileUrl=JSON.parse(e.remarkFileUrl),e.remarkFileUrl.push("http://video-static.xdcdn.xiaodutv.com/browse_static/v3/common/widget/global/player/newPlayer_e2332cd1.swf"),e.remarkFileUrl=JSON.stringify(e.remarkFileUrl),t.model.setData("apiData",e)}),this.dom.find(".apidata").on("change",function(){if(ES.selctorDoc(this).attr("api")){var t=ES.selctorDoc(this).attr("api"),a=e.model.getData("apiData");a[t]=JSON.stringify(ES.selctorDoc(this).val().trim()).slice(1,-1),e.model.setData("apiData",a)}}),this.dom.find(".name").on("blur",function(){if("view"!==this.type){if(ES.selctorDoc(this).removeClass("redborder"),ES.selctorDoc(this).parent().find(".required1").remove(),ES.selctorDoc(this).parent().find(".required").remove(),ES.selctorDoc(this).val().trim()==this.proname)return;ES.selctorDoc(this).val().trim()}}),this.app.header.event._addEvent("header.changePageError",function(){t.dom.find(".redlabel").removeClass("redborder"),t.dom.find(".required").remove(),t.dom.find(".inputLine").dom.forEach(function(t,e){""!==Tool.checkForm(ES.selctorDoc(t).dom,"red")&&(t.find("."+t.attr("redlabel")).addClass("redborder"),t.find("."+t.attr("redlabel")).after('<span class="required">'+Tool.checkForm(ES.selctorDoc(t).dom,"red")+"</span>"))})}),this.dom.find(".save").on("click",i(regeneratorRuntime.mark(function e(){var a,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.dom.find(".redborder").removeClass("redborder"),t.dom.find(".required").remove(),t.dom.find(".inputLine").dom.forEach(function(t,e){""!==Tool.checkForm(ES.selctorDoc(t).dom,"red")&&(t.find("."+t.attr("redlabel")).addClass("redborder"),t.find("."+t.attr("redlabel")).after('<span class="required">'+Tool.checkForm(ES.selctorDoc(t).dom,"red")+"</span>"))}),!t.dom.find(".redborder").dom||!t.dom.find(".redborder").dom.some(function(t){return 0!==t.box().clientHeight})){e.next=7;break}return e.abrupt("return",!1);case 7:if("new"!=t.type){e.next=16;break}return t.app.loading.show(),e.next=11,t.api.audit_task_create(t.model.getData("apiData"));case 11:a=e.sent,t.app.loading.hide(),0==a.code?(t.app.session.clearAll(),t.app.changePage("createaudittask2",{type:"edit",taskid:a.data.id,projectid:t.model.apiData.projectId,status:1})):t.errorshow(a.msg),e.next=25;break;case 16:return(n=JSON.parse(JSON.stringify(t.model.getData("apiData")))).isBasic=!0,n.id=parseInt(t.taskid),t.app.loading.show(),e.next=22,t.api.audit_task_update(n);case 22:i=e.sent,t.app.loading.hide(),0==i.code?(t.app.session.clearAll(),t.app.changePage("createaudittask2",{type:"edit",taskid:t.taskid,projectid:t.model.getData("apiData").projectId,status:t.status})):t.errorshow(i.msg);case 25:case"end":return e.stop()}},e,t)})))}},{key:"errorshow",value:function(t){this.app.alert.show({title:" ",msg:t,close:!1})}},{key:"render",value:function(){var t=i(regeneratorRuntime.mark(function t(){var e,a,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},a={id:this.taskid},this.app.loading.show(),t.next=5,this.api.audit_task_read(a);case 5:n=t.sent,this.app.loading.hide(),0==n.code?(e.projectId=n.data.projectId,e.name=n.data.name,e.description=n.data.description,e.remark=n.data.remark):this.errorshow(n.msg),this.proname=e.name,this.model.setData("apiData",e),console.log(this.dom.find(".project .option"),e.projectId),this.dom.find('.project .option[data-idx="'+e.projectId+'"]').dom&&this.dom.find('.project .option[data-idx="'+e.projectId+'"]').click(),this.dom.find(".apidata[api=name]").val(e.name),this.dom.find(".apidata[api=remark]").val(JSON.parse('"'+e.remark+'"')),this.dom.find(".apidata[api=description]").val(JSON.parse('"'+e.description+'"')),this.app.session.clearAll(),"view"==this.type&&(this.dom.find(".apidata").attr("readonly","readonly"),this.project.disable()),1!==this.status&&this.project.disable();case 18:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"upload",value:function(){var t=this,e=function(){var t;return function(){return t||(t=new FormData),t}}();FormData.prototype.deleteAll=function(){var t=this;this.forEach(function(e,a){t.delete(a)})};var a=document.getElementById("uploadarea");a.ondragover=function(t){t.preventDefault(),this.style.borderColor="red"},a.ondrop=function(a){t.style.borderColor="gray",a.preventDefault();var n,i,r,o=a.dataTransfer.files,s=o.length,d=0,p=document.createDocumentFragment(),c=e();for(c.entries();d<s;){n=document.createElement("tr"),r=Math.round(100*o[d].size/1024)/100+"KB",i=o[d].lastModifiedDate.toLocaleDateString()+" "+o[d].lastModifiedDate.toTimeString().split(" ")[0],n.innerHTML="<td>"+o[d].name+"</td><td>"+i+"</td><td>"+r+"</td><td>删除</td>";var l='<li class="file">\n                        <i class="iconfont icon-qubiezhen"></i>\n                        <span class="filename">'+o[d].name+'</span>\n                        <span class="progress"></span>                        <i class="iconfont icon-guanbi"></i>                    </li>';ES.selctorDoc(".filelist").append(l),p.appendChild(n),c.append(o[d].name,o[d]),d++}t.upload1(e)}}},{key:"upload1",value:function(t){var e=t();$.ajax({url:"upload",type:"POST",data:e,async:!0,cache:!1,contentType:!1,processData:!1,success:function(t){alert("succeed!"),closeModal(),t.deleteAll(),$(".tbody").empty()},error:function(t){alert("failed!")}})}},{key:"uploadufile",value:function(){var t=this.dom.find(".dianjiupload").val(),e=document.getElementById("uploader").files[0],a={file:e,fileRename:t};this.ufile.uploadFile(a,function(t){alert("上传成功");var a='<li class="file" linkurl="'+t+'">\n                        <i class="iconfont icon-qubiezhen"></i>\n                        <span class="filename">'+e.name+'</span>\n                        <span class="progress"></span>                        <i class="iconfont icon-guanbi"></i>                    </li>';console.log(ES.selctorDoc(".filelist").dom,"dom"),ES.selctorDoc(".filelist").append(a)},function(t){console.error("errorCallBack",t)},function(t){var e="上传进度："+100*t+"%";console.log(e)})}}]),e}();t.exports=r},824:function(t,e,a){var n=a(2144);"string"==typeof n&&(n=[[t.i,n,""]]);var i={transform:void 0};a(705)(n,i);n.locals&&(t.exports=n.locals)},825:function(t,e,a){"use strict";var n="/audit/task/create",i="/audit/task/update",r="/audit/project/name/venderId/search",o="/audit/task/read",s={audit_task_create:function(t){return this.HttpRequest.POST(n,t)},audit_task_update:function(t){return this.HttpRequest.POST(i,t)},audit_project_name_search:function(t){return this.HttpRequest.POST(r,t)},audit_task_read:function(t){return this.HttpRequest.POST(o,t)}};t.exports=s},826:function(t,e){t.exports='<div class=createaudittask1> <div class=scroll> <a class="biaozhubtn save">保存</a> <p class=title>第一步：审核任务信息</p> <div class="inputLine w50" redlabel=inputBox> <span class=w135><label class=redstar>*</label>审核任务名称：</span> <input type=text class="inputBox apidata name" check=empty api=name /> </div> <div class="inputLine w50" redlabel=xlk> <span class=w135><label class=redstar>*</label>所属审核项目：</span> <div class=project check=empty></div> </div> <div class="inputLine w100" redlabel=inputBox> <span class=w135>审核任务描述：</span> <textarea type=text class="inputBox apidata" check="" api=description></textarea> </div> <div class=uploadarea id=uploadarea> <img src=/images/page/shangchuan.png> <p>可以上传图片、视频文件等规范外部医生标注</p> <input type=file class=dianjiupload id=uploader /> </div> <ul class=filelist> </ul> <div class="inputLine w100" redlabel=inputBox> <span class=w135>审核任务备注：</span> <textarea type=text class="inputBox apidata" check="" api=remark></textarea> </div> </div> </div>'},827:function(t,e,a){"use strict";var n=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.listInfo={},a.hospitalInfo={},a.modalityInfo={},a.totalInfo={},a.componentdata={},a.apiData={name:"",remark:"",remarkFileUrl:"[]"},a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Interstellar.modelBase),e}();t.exports=n}});