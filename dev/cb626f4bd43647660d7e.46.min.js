webpackJsonp([46],{

/***/ 161:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

//这边基本上引入需要使用的资源less，api，需要使用的模块等等。


//var pagebaseClass = require('../base/es6pagebase')
//var JSEncrypt = require('../libs/jsencrypt.js');

var login = function (_Interstellar$pagesBa) {
  _inherits(login, _Interstellar$pagesBa);

  function login() {
    _classCallCheck(this, login);

    return _possibleConstructorReturn(this, (login.__proto__ || Object.getPrototypeOf(login)).apply(this, arguments));
  }

  _createClass(login, [{
    key: 'complete',
    value: function complete() {
      // this.app.session.clearAll()
      var that = this;
      that.styleModel(1);
      that.dom.find('.registerbtn').on('click', function () {
        that.app.changePage('register');
      });
      that.dom.find('.reset ._cancel').on('click', function () {
        that.dom.find('.contains').removeClass('hide');
        that.dom.find('.reset').addClass('hide');
      });
      that.dom.find('.forget').on('click', function () {
        that.dom.find('.contains').addClass('hide');
        that.dom.find('.reset').removeClass('hide');
      });
      //let dropdown = require.sure('../moduleslibs/dropdown/dropdown.js');
      this.flag = true;
      console.log(this.app.local.get('isRemember'));
      if (this.app.local.get('isRemember') == 'true') {
        if (that.app.local.get('all')) {
          that.dom.find('.name').val(that.app.local.get('username'));
          that.dom.find('.password').val(that.app.local.get('password'));
          that.dom.find('.remeber i').addClass('choose');
        }
      }
      that.dom.find('.tosee').on('click', function () {
        if (that.flag) {
          ES.selctorDoc(this).find('.iconfont').removeClass('icon-biyan');
          ES.selctorDoc(this).find('.iconfont').addClass('icon-chakan');
          that.dom.find('.password').attr('type', 'text');
          that.flag = false;
        } else {
          ES.selctorDoc(this).find('.iconfont').removeClass('icon-chakan');
          ES.selctorDoc(this).find('.iconfont').addClass('icon-biyan');
          that.dom.find('.password').attr('type', 'password');
          that.flag = true;
        }
      });
      that.dom.find('.loginBtn').on('click', function () {
        that.loginCheck();
      });
      that.dom.find('.password').on('keydown', function (e) {
        if (e.keyCode == 13) {
          that.loginCheck();
        }
      });
      that.dom.find('.remeber i').on('click', function () {
        if (!ES.selctorDoc(this).hasClass('choose')) {
          ES.selctorDoc(this).addClass('choose');
        } else {
          ES.selctorDoc(this).removeClass('choose');
        }
      });
      that.dom.find('.forget').on('click', function () {
        var changepwd = that.app.languageMode.getTranslate(that.app.language, 'login', 'changepwd');
        if (that.app.cloud) {
          that.dom.find('.contains').hide();
          that.dom.find('.retrieve').show();
        } else {
          that.dom.find('.errorSpan').removeClass('hide');
          // that.dom.find('.errorSpan').html('请联系管理员修改密码')
          that.dom.find('.errorSpan').html(changepwd);
        }
      });
    }
  }, {
    key: 'loginCheck',
    value: function loginCheck() {
      var that = this;
      ES.selctorDoc('.errorSpan').addClass('hide');
      ES.selctorDoc('.errorSpan').html('');
      var loginName = ES.selctorDoc('.name').val();
      var password = encodeURIComponent(ES.selctorDoc('.password').val());
      // console.log(password,'password')
      if (loginName == '') {
        ES.selctorDoc('.errorSpan').removeClass('hide');
        ES.selctorDoc('.errorSpan').html('用户名不能为空');
      } else if (password == '') {
        ES.selctorDoc('.errorSpan').removeClass('hide');
        ES.selctorDoc('.errorSpan').html('密码不能为空');
      } else {
        var json = {
          phone: loginName.replace(/ /g, ''),
          pwd: password
        };
        that.app.loading.show();
        that.api.login(json).then(function (res) {
          that.app.loading.hide();
          if (res.code == 0) {
            if (that.dom.find('.remeber i').hasClass('choose')) {
              that.app.local.set('isRemember', "true");
              that.app.local.set('username', loginName);
              that.app.local.set('password', ES.selctorDoc('.password').val());
            } else {
              that.app.local.set('isRemember', "");
              that.app.local.set('username', '');
              that.app.local.set('password', '');
            }
            var _json = {
              name: res.data.user.name,
              userId: res.data.user.id,
              roles: res.data.roleList,
              group: res.data.group,
              productList: res.data.user.productList,
              status: res.data.user.status
            };
            that.app.local.set('all', JSON.stringify(_json));
            that.app.local.set('accessToken', res.data.accessToken);
            if (JSON.stringify(res.data.roleList) == '[]' || res.data.roleList[0].code == 'ADMIN') {
              that.app.local.set('identity', 'gly');
              that.app.changePage('projectmanage', { type: 'fs' });
              ES.ajax({
                url: that.app.domain3 + 'v1/dict/child/query',
                type: "POST",
                dataType: "json",
                contentType: "application/json",
                questring: { value: null }
              }).then(function (response) {
                if (!that.app.apiresult(response)) {
                  return;
                }
                if (response.data) {
                  response.data.map(function (item) {
                    that.app.constmap[item.value] = item;
                  });
                }
              });
              that.app.menu.refreshmenu();
            } else if (res.data.roleList[0].code == 'doctor.tourist') {
              that.app.local.set('identity', 'bzys');
              that.app.changePage('personalaccount');
              that.app.menu.refreshmenu();
            } else if (res.data.roleList[0].code == 'doctor.research') {
              that.app.local.set('identity', 'bzys');
              that.app.changePage('personalaccount');
              that.app.menu.refreshmenu();
            } else if (res.data.roleList[0].code == 'doctor.audit') {
              that.app.local.set('identity', 'bzys');
              that.app.changePage('personalaccount');
              that.app.menu.refreshmenu();
            }
            that.app.header.setloginname();
          } else if (res.code == '500') {
            ES.selctorDoc('.errorSpan').removeClass('hide');
            ES.selctorDoc('.errorSpan').html('用户名或密码错误，请重新输入');
          } else if (res.code == '503') {
            ES.selctorDoc('.errorSpan').removeClass('hide');
            ES.selctorDoc('.errorSpan').html('账户已被冻结。');
            setTimeout(function () {
              ES.selctorDoc('.errorSpan').html('');
            }, 5000);
          } else if (res.code == '508') {
            ES.selctorDoc('.errorSpan').removeClass('hide');
            ES.selctorDoc('.errorSpan').html('该账户已被禁用，请联系客服');
          }
        });
      }
    }
  }]);

  return login;
}(Interstellar.pagesBase);

module.exports = login;

/***/ }),

/***/ 504:
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__(891);
if(typeof content === 'string') content = [[module.i, content, '']];
// Prepare cssTransformation
var transform;

var options = {}
options.transform = transform
// add the styles to the DOM
var update = __webpack_require__(471)(content, options);
if(content.locals) module.exports = content.locals;
// Hot Module Replacement
if(false) {
	// When the styles change, update the <style> tags
	if(!content.locals) {
		module.hot.accept("!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./login.less", function() {
			var newContent = require("!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./login.less");
			if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
			update(newContent);
		});
	}
	// When the module is disposed, remove the <style> tags
	module.hot.dispose(function() { update(); });
}

/***/ }),

/***/ 505:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var urlDict = {
  login: '/tUser/login',
  sendyzm: '/user/captcha/send',
  verifycode: '/user/captcha/verify',
  forgetpwd: '/user/password/forget'
};
var api = {
  login: function login(value) {
    var deferred = ES.Deferred();
    ES.ajax({
      url: api.app.domain1 + 'v1/user/login',
      type: "GET",
      dataType: "json",
      contentType: "application/json",
      questring: value
    }).then(function (response) {
      deferred.resolve(response);
    }, function () {
      deferred.reject(true);
    });
    return deferred;
  },
  sendyzm: function sendyzm(value) {
    return this.HttpRequest.POST(urlDict.sendyzm, value);
  },
  verifycode: function verifycode(value) {
    return this.HttpRequest.POST(urlDict.verifycode, value);
  },
  forgetpwd: function forgetpwd(value) {
    return this.HttpRequest.POST(urlDict.forgetpwd, value);
  }
};
module.exports = api;

/***/ }),

/***/ 506:
/***/ (function(module, exports) {

module.exports = "<div class=login> <div class=logo data-i18n=\"\" data-name=杏脉科技> <img src=/images/page/zjlogo2x.png> </div> <div class=\"contains clearfix\"> <div class=loginForm> <div class=formheader> <span><label class=yz>登录</label></span> </div> <div class=formcontains> <span class=\"errorSpan hide\"></span> <div class=inputLine> <i class=jia>+86</i> <input type=text class=name placeholder=手机号 /> </div> <div class=\"inputLine pwd\"> <i class=\"iconfont icon-mima\"></i> <input type=password class=password placeholder=请输入密码 autocomplete=new-password /> </div> <div class=mimaxg> <a class=remeber><i class=check-box></i>记住密码</a> <a class=forget>忘记密码?</a> </div> <a class=loginBtn>登录</a> </div> </div> <div class=wordArea> <p class=line1> <img src=/images/page/jianying.png style=width:400px;height:71px> </p> <p class=mb60> <img src=/images/page/3.png style=width:388px;height:33px> </p> <div class=\"registerbtn hide\">新用户注册</div> </div> </div> <div class=\"reset hide\"> <div class=_title data-i18n=resetpwd data-name=重置密码>重置密码</div> <span class=\"errorPwd hide\"></span> <div class=_telphone> <input type=text class=_tel placeholder=手机号 data-code=tel> <i class=_num>+86</i> </div> <div class=_code> <div class=_verification> <i class=\"iconfont icon-jianpan\"></i> <input type=text class=_identcode placeholder=验证码 data-code=code> </div> <div class=_getcode data-i18n=getcode data-name=获取验证码>获取验证码</div> </div> <div class=_newpwd> <input type=password class=_newp placeholder=请输入新密码 autocomplete=new-password data-code=newpwd> <i class=\"iconfont icon-biyan\"></i> </div> <div class=_footer> <p href=javascript:; class=\"_confirm _btn\" data-i18n=confirm data-name=确认>找回密码</p> <p href=javascript:; class=\"_cancel _btn\" data-i18n=cancel data-name=取消>转到登录页面？</p> </div> </div> </div> ";

/***/ }),

/***/ 507:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var loginmodel = function (_Interstellar$modelBa) {
    _inherits(loginmodel, _Interstellar$modelBa);

    function loginmodel(app) {
        _classCallCheck(this, loginmodel);

        var _this = _possibleConstructorReturn(this, (loginmodel.__proto__ || Object.getPrototypeOf(loginmodel)).call(this, app));

        _this.proseriesdata = { page: 1, pageSize: 10, isselected: 'no' };
        return _this;
    }

    return loginmodel;
}(Interstellar.modelBase);

module.exports = loginmodel;

/***/ }),

/***/ 891:
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(470)(false);
// imports


// module
exports.push([module.i, "#login-content-fade {\n  height: 100%;\n}\n.login {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  background: url(/images/page/beijing.jpg) no-repeat;\n  background-size: cover;\n}\n.login .clearfix:before,\n.login .clearfix:after {\n  content: \"\";\n  display: block;\n  clear: both;\n}\n.login .clearfix {\n  zoom: 1;\n}\n.login .logo {\n  padding-left: 40px;\n  padding-top: 40px;\n  font-size: 24px;\n  line-height: 31px;\n  color: #CBD5E6;\n  letter-spacing: 0;\n}\n.login .logo p {\n  font-family: MicrosoftYaHei;\n  font-size: 34px;\n  color: #E8E8E8;\n  letter-spacing: 0;\n}\n.login .logo .chinese {\n  font-size: 25px;\n  margin-top: 5px;\n}\n.login .logo img {\n  width: 216px;\n}\n.login .contains {\n  height: 440px;\n  width: 1204px;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.login .wordArea {\n  float: right;\n  width: 638px;\n  margin-right: 100px;\n}\n.login .wordArea .registerbtn {\n  border: 1px solid #448E97;\n  border-radius: 4px;\n  background: transparent;\n  width: 240px;\n  height: 60px;\n  line-height: 60px;\n  font-size: 24px;\n  text-align: center;\n  color: #448E97;\n  cursor: pointer;\n}\n.login .wordArea p {\n  font-family: \"Microsoft YaHei\";\n  font-size: 2.4rem;\n  color: #ACB6C4;\n  letter-spacing: 4px;\n}\n.login .wordArea .line1 {\n  margin-bottom: 50px;\n  margin-top: 120px;\n}\n.login .loginForm {\n  float: right;\n  background: rgba(229, 229, 229, 0.2);\n  border-radius: 4px;\n  text-align: center;\n  position: relative;\n  width: 464px;\n}\n.login .loginForm .formheader {\n  height: 60px;\n  line-height: 60px;\n  background: rgba(229, 229, 229, 0.45);\n  border-radius: 5px;\n  margin-bottom: 100px;\n}\n.login .loginForm .formheader span {\n  width: 230px;\n  text-align: center;\n  color: #fff;\n  font-size: 25px;\n}\n.login .loginForm .formheader label {\n  cursor: pointer;\n}\n.login .loginForm .formheader .headerline {\n  width: 112px;\n  border-bottom: 2px solid #000;\n  height: 48px;\n  line-height: 48px;\n  display: inline-block;\n}\n.login .loginForm .formcontains {\n  position: relative;\n  /*ie文本框背景色*/\n  /*ie文本输入框眼睛*/\n}\n.login .loginForm .formcontains .dl {\n  font-family: \"Microsoft YaHei\";\n  font-size: 24px;\n  color: #FFFFFF;\n  margin-top: 27px;\n  margin-bottom: 58px;\n  line-height: 30px;\n}\n.login .loginForm .formcontains .errorSpan {\n  position: absolute;\n  color: #FF3636;\n  top: 68px;\n  font-size: 15px;\n  left: 140px;\n  transform: translateX(-50%);\n  line-height: 16px;\n  text-align: left;\n}\n.login .loginForm .formcontains .name {\n  margin-bottom: 50px;\n  width: 345px;\n}\n.login .loginForm .formcontains input {\n  height: 50px;\n  font-size: 16px;\n  color: #fff;\n  font-family: \"Microsoft YaHei\";\n  background: unset;\n  border: 1px solid #fff;\n  border-radius: 5px;\n  padding-left: 55px;\n}\n.login .loginForm .formcontains input::-ms-clear {\n  display: none;\n}\n.login .loginForm .formcontains input::-ms-reveal {\n  display: none;\n}\n.login .loginForm .formcontains ::-webkit-input-placeholder {\n  /* WebKit browsers */\n  color: #fff;\n}\n.login .loginForm .formcontains :-moz-placeholder {\n  /* Mozilla Firefox 4 to 18 */\n  color: #fff;\n}\n.login .loginForm .formcontains ::-moz-placeholder {\n  /* Mozilla Firefox 19+ */\n  color: #fff;\n}\n.login .loginForm .formcontains :-ms-input-placeholder {\n  /* Internet Explorer 10+ */\n  color: #fff;\n}\n.login .loginForm .formcontains .inputLine {\n  width: 400px;\n  border-radius: 4px;\n  margin: 0 auto;\n  text-align: left;\n  position: relative;\n}\n.login .loginForm .formcontains .inputLine .icon-xingzhuang1,\n.login .loginForm .formcontains .inputLine .icon-mima {\n  position: absolute;\n  font-size: 18px;\n  top: 16px;\n  left: 19px;\n  color: #fff;\n}\n.login .loginForm .formcontains .inputLine .password {\n  width: 345px;\n}\n.login .loginForm .formcontains .inputLine .jia {\n  position: absolute;\n  left: 10px;\n  top: 16px;\n  color: #fff;\n  font-size: 16px;\n  font-style: normal;\n}\n.login .loginForm .formcontains .mimaxg {\n  line-height: 35px;\n  height: 35px;\n}\n.login .loginForm .formcontains .mimaxg a {\n  font-size: 14px;\n  color: #fff;\n}\n.login .loginForm .formcontains .mimaxg .remeber {\n  float: left;\n  margin-left: 35px;\n}\n.login .loginForm .formcontains .mimaxg .remeber i {\n  vertical-align: middle;\n  margin-right: 4px;\n}\n.login .loginForm .formcontains .mimaxg .forget {\n  float: right;\n  margin-right: 35px;\n  text-decoration: underline;\n}\n.login .loginForm .formcontains .loginBtn {\n  display: inline-block;\n  height: 50px;\n  line-height: 50px;\n  background: #448e97;\n  border-radius: 4px;\n  font-family: \"MicrosoftYaHei\";\n  font-size: 18px;\n  color: #FFFFFF;\n  width: 400px;\n  margin-top: 50px;\n  margin-bottom: 40px;\n}\n.login .mb60 {\n  margin-bottom: 60px;\n}\n.login .mb80 {\n  margin-bottom: 80px;\n}\n.login .reset {\n  width: 465px;\n  height: 440px;\n  margin: 0 auto;\n  padding-top: 50px;\n  font-size: 14px;\n  background: rgba(229, 229, 229, 0.2);\n  border-radius: 4px;\n  text-align: center;\n}\n.login .reset > div {\n  margin-bottom: 30px;\n  position: relative;\n}\n.login .reset input {\n  border: 1px solid #e8e8e8;\n  border-radius: 4px;\n  height: 50px;\n  outline: none;\n  color: #333;\n  width: 320px;\n  font-size: 14px;\n  background: transparent;\n  position: relative;\n}\n.login .reset ._tel {\n  padding-left: 30px;\n  width: 290px;\n}\n.login .reset ::-webkit-input-placeholder {\n  /* WebKit browsers */\n  color: #fff;\n}\n.login .reset :-moz-placeholder {\n  /* Mozilla Firefox 4 to 18 */\n  color: #fff;\n}\n.login .reset ::-moz-placeholder {\n  /* Mozilla Firefox 19+ */\n  color: #fff;\n}\n.login .reset :-ms-input-placeholder {\n  /* Internet Explorer 10+ */\n  color: #fff;\n}\n.login .reset ._title {\n  height: 30px;\n  line-height: 30px;\n  font-size: 24px;\n  margin-bottom: 35px;\n  color: #fff;\n  text-align: center;\n}\n.login .reset ._code ._verification {\n  width: 210px;\n  display: inline-block;\n}\n.login .reset ._code input {\n  width: 170px;\n  margin-left: 33px;\n}\n.login .reset ._code ._getcode {\n  width: 125px;\n  font-size: 14px;\n  display: inline-block;\n  float: right;\n  height: 50px;\n  line-height: 50px;\n  text-align: center;\n  opacity: 0.73;\n  background: #448E97;\n  border-radius: 4px;\n  color: #FFFFFF;\n  cursor: pointer;\n  margin-right: 74px;\n  margin-left: -10px;\n}\n.login .reset ._code ._getcode:hover {\n  background: #1F474C;\n}\n.login .reset ._code ._getcode._getting {\n  background: #9B9B9B;\n  cursor: default;\n  pointer-events: none;\n}\n.login .reset ._code .icon-jianpan {\n  left: 10px;\n}\n.login .reset ._num {\n  position: absolute;\n  top: 18px;\n  left: 73px;\n  font-style: normal;\n  color: #fff;\n}\n.login .reset ._newpwd input {\n  margin-left: 10px;\n}\n.login .reset ._newpwd .icon-chakan {\n  right: 20px;\n}\n.login .reset ._footer {\n  height: 50px;\n}\n.login .reset ._btn {\n  width: 320px;\n  height: 40px;\n  line-height: 40px;\n  margin: 0 auto;\n  border-radius: 4px;\n}\n.login .reset ._confirm {\n  color: #fff;\n  background: #448E97;\n  border: 1px solid #448E97;\n}\n.login .reset ._confirm:hover {\n  background: #1F474C;\n  border: 1px solid #1F474C;\n}\n.login .reset ._cancel {\n  background: transparent;\n  color: #fff;\n  letter-spacing: 2px;\n  cursor: pointer;\n}\n", ""]);

// exports


/***/ })

});
//# sourceMappingURL=cb626f4bd43647660d7e.46.min.js.map