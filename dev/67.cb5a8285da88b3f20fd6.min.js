webpackJsonp([67],{2012:function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();t(2013);var r=function(e){function n(e,o,r,i){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var a=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,o,r,i));return a.html=t(2015),a.name="roleModal",a.roleScroll=null,a}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(n,Interstellar.modalBase),o(n,[{key:"complete",value:function(){var e=this;this.initView(),"EDIT"==this.api.type&&this.dom.find(".modal-title").html("修改角色"),this.dom.find(".roleList").on("mouseover",function(n){var t=ES.selctorDoc(n.target).parent();if(e.dom.find(".actionUl").remove(),-1!==n.target.className.lastIndexOf("perName")){var o=e.api.data[t.attr("did")].data,r="";o[0].forEach(function(e){if(r+="<li>"+e.name,o[e.id]){r+="(";var n=o[e.id].length;o[e.id].forEach(function(e,t){r+=e.name,t!==n-1&&(r+=",")}),r+=")"}r+="</li>"});var i='<ul class="actionUl">'+r+"</ul>";t.append(i)}}),this.dom.find(".roleList").on("click",function(n){var t=ES.selctorDoc(n.target);e.dom.find(".actionUl").remove(),-1!==n.target.className.lastIndexOf("check-box")&&(t.hasClass("choose")?t.removeClass("choose"):t.addClass("choose"))}),this.setData()}},{key:"setData",value:function(e){var n="";for(var t in this.api.data)n+='<li class="permissions" did="'+t+'"><i class="check-box"></i><span class="perName">'+this.api.data[t].name+"</span></li>";this.dom.find(".roleScroll").append(n),this.initscroll(this.roleScroll,"roleList")}},{key:"initView",value:function(){var e=this,n=this;this.dom.find(".icon-guanbi").on("click",function(){n.close()}),this.dom.find(".btn-cancel").on("click",function(){n.close()}),this.dom.find(".inputBox").on("blur",function(){n.event._dispatch("roleModal.roleName",{name:ES.selctorDoc(this).val()})}),this.dom.find(".btn-confirm").on("click",function(){if(n.dom.find(".inputLine").dom.forEach(function(e,n){e.find("."+e.attr("redlabel")).removeClass("redborder"),e.find(".required").remove(),""!==Tool.checkForm(ES.selctorDoc(e).dom,"red")&&(e.find("."+e.attr("redlabel")).addClass("redborder"),e.find("."+e.attr("redlabel")).after('<span class="required">'+Tool.checkForm(ES.selctorDoc(e).dom,"red")+"</span>"))}),n.dom.find(".redborder").dom)return!1;var t={name:e.dom.find('.inputBox[api="name"]').val(),permissionIdList:[]};e.dom.find(".roleList .choose").dom&&e.dom.find(".roleList .choose").dom.forEach(function(e){t.permissionIdList.push(1*e.parent().attr("did"))}),n.event._dispatch("roleModal.submit",t)})}},{key:"renderData",value:function(e){var n=this;e.permissionList.forEach(function(e){n.dom.find('.roleList li[did="'+e.permissionId+'"] .check-box').addClass("choose")}),this.dom.find('.inputBox[api="name"]').val(e.name)}},{key:"showError",value:function(e){this.dom.find(".inputBox").after('<span class="required">'+e+"</span>"),this.dom.find(".inputBox").addClass("redborder")}},{key:"initscroll",value:function(e,n){if(e)e.refresh();else{var t="aaa_"+Math.floor((new Date).getTime()*Math.random());ES.selctorDoc("."+n).attr("id",t),e=new IScroll("#"+t,{scrollbars:!0,mouseWheel:!0,scrollX:!0,interactiveScrollbars:!0,hideScrollbar:!1,vScrollbar:!0,shrinkScrollbars:"scale",fadeScrollbars:!1,disableMouse:!0,disablePointer:!0})}}}]),n}();e.exports=r},2013:function(e,n,t){var o=t(2014);"string"==typeof o&&(o=[[e.i,o,""]]);var r={transform:void 0};t(705)(o,r);o.locals&&(e.exports=o.locals)},2014:function(e,n,t){(e.exports=t(704)(!1)).push([e.i,'.roleModal {\n  margin-left: -250px;\n  margin-top: -240px;\n  width: 590px;\n  font-size: 14px;\n}\n.roleModal .modal-header {\n  height: 40px;\n  line-height: 40px;\n  padding: 0;\n  padding-left: 20px;\n  background: #F4F4F4;\n}\n.roleModal .modal-header .modal-title {\n  font-family: MicrosoftYaHei;\n  font-weight: bold;\n  font-size: 18px;\n  color: #333333;\n  letter-spacing: 0;\n}\n.roleModal .modal-header i {\n  font-size: 15px;\n  float: right;\n  margin-right: 20px;\n  cursor: pointer;\n}\n.roleModal .modal-body {\n  padding: 0px !important;\n  margin: 0 20px;\n}\n.roleModal .modal-body span {\n  margin-left: 0px;\n}\n.roleModal .modal-body .top {\n  margin: 20px 0;\n}\n.roleModal .modal-body .inputLine {\n  display: inline-block;\n  position: relative;\n}\n.roleModal .modal-body .inputLine > div {\n  display: inline-block;\n}\n.roleModal .modal-body .inputLine .confirm {\n  margin-right: 0;\n}\n.roleModal .modal-body .inputLine .inputBox {\n  width: 178px;\n  height: 30px;\n  line-height: 30px;\n  border: 1px solid #E8E8E8;\n  border-radius: 4px;\n  outline: none;\n  padding-left: 10px;\n}\n.roleModal .modal-body .inputLine .xlk {\n  width: 310px;\n  height: 38px;\n  line-height: 38px;\n}\n.roleModal .modal-body .inputLine .xlk i {\n  color: #CCCCCC;\n}\n.roleModal .modal-body .inputLine .names {\n  font-family: "MicrosoftYaHei";\n  font-size: 14px;\n  color: #333333;\n  letter-spacing: 0;\n  margin-right: 10px;\n}\n.roleModal .modal-body .inputLine .w61 {\n  width: 61px;\n  margin-left: 45px;\n}\n.roleModal .modal-body .inputLine .ml45 {\n  margin-left: 45px;\n}\n.roleModal .modal-body .inputLine .type {\n  line-height: 18px;\n}\n.roleModal .modal-body .inputLine .userType {\n  display: inline-block;\n  width: 240px;\n  text-align: left;\n}\n.roleModal .modal-body .inputLine .userType span {\n  margin-left: 0px;\n  line-height: 18px;\n}\n.roleModal .modal-body .inputLine .forget {\n  color: #448E97;\n}\n.roleModal .modal-body .inputLine .errorMessage {\n  color: red;\n}\n.roleModal .modal-body .inputLine:first-child {\n  margin-right: 35px;\n}\n.roleModal .modal-body .userconfig {\n  padding: 20px 0;\n  border-top: 1px dashed #E8E8E8;\n  border-bottom: 1px dashed #E8E8E8;\n  display: flex;\n}\n.roleModal .modal-body .userconfig > p {\n  display: inline-block;\n}\n.roleModal .modal-body .roleList {\n  flex: 1;\n  display: flex;\n  flex-wrap: wrap;\n}\n.roleModal .modal-body .roleList .roleScroll {\n  display: flex;\n  flex-wrap: wrap;\n}\n.roleModal .modal-body .roleList .roleScroll > li {\n  line-height: 25px;\n  position: relative;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.roleModal .modal-body .roleList .roleScroll > li .check-box {\n  margin-right: 5px;\n  vertical-align: middle;\n}\n.roleModal .modal-body .roleList .roleScroll > li span {\n  overflow: hidden;\n  vertical-align: bottom;\n}\n.roleModal .modal-body .roleList .actionUl {\n  position: absolute;\n  background: rgba(0, 0, 0, 0.6);\n  border-radius: 2px;\n  color: #FFFFFF;\n  padding: 8px;\n  z-index: 1000;\n}\n.roleModal .modal-body .roleList .actionUl > li {\n  white-space: nowrap;\n}\n.roleModal .modal-body .roleList .actionUl > li .perName {\n  width: 70%;\n  overflow: hidden;\n}\n.roleModal .modal-footer {\n  margin: 26px 0 20px 0;\n  text-align: end;\n}\n.roleModal .modal-footer .btn {\n  width: 70px;\n  height: 30px;\n  line-height: 30px;\n  margin-left: 20px;\n}\n.roleModal .required {\n  position: relative;\n  margin-left: 100px !important;\n}\n',""])},2015:function(e,n){e.exports='<div class="modal roleModal"> <div class=modal-header> <p class=modal-title>创建角色</p> <i class="iconfont icon-guanbi"></i> </div> <div class=modal-body> <div class=top> <div class=inputLine redlabel=inputBox> <span class=names data-i18n=gh data-name=姓名>角色名称</span> <input type=text class=inputBox check=empty api=name /> </div> </div> <div class=userconfig> <p class=title>角色配置：</p> <ul class=roleList> <div class=roleScroll></div> </ul> </div> </div> <div class=modal-footer> <a class="btn btn-cancel">取消</a> <a class="btn btn-confirm">确定</a> </div> </div> '},2016:function(e,n,t){(e.exports=t(704)(!1)).push([e.i,".rolemanage {\n  min-height: 837px;\n  background: #fff;\n  display: flex;\n}\n.rolemanage .leftArea {\n  position: relative;\n  width: 180px;\n  border-right: 1px solid #e8e8e8;\n}\n.rolemanage .leftArea .roleName {\n  background: #ffffff;\n  border: 1px solid #e8e8e8;\n  border-radius: 4px;\n  width: 120px;\n  padding-left: 30px;\n  height: 30px;\n  margin: 10px 14px 20px 16px;\n}\n.rolemanage .rightArea {\n  flex: 1;\n  position: relative;\n}\n.rolemanage .icon-sousuo {\n  font-size: 14px;\n  color: #e8e8e8;\n  position: absolute;\n  top: 18px;\n  left: 25px;\n}\n.rolemanage .listArea {\n  flex: 1;\n  padding-top: 10px;\n  position: relative;\n}\n.rolemanage .roleList {\n  margin-top: 20px;\n}\n.rolemanage .roleList li {\n  display: flex;\n  line-height: 40px;\n  font-size: 14px;\n  color: #000000;\n}\n.rolemanage .roleList li .roleName {\n  width: 30%;\n  margin-left: 20px;\n}\n.rolemanage .roleList li .roleContent {\n  flex: 1;\n}\n.rolemanage .roleList li .permissions {\n  vertical-align: top;\n  width: 45%;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n}\n.rolemanage .roleList li .soft {\n  color: #666666;\n}\n.rolemanage .noData {\n  height: 150px;\n  line-height: 150px;\n  font-size: 20px;\n  text-align: center;\n  vertical-align: middle;\n  font-weight: bolder;\n}\n.rolemanage .roleList li:nth-child(2n) {\n  background: #fafafa;\n}\n.rolemanage .roleTitle {\n  font-family: MicrosoftYaHei-Bold;\n  font-size: 14px;\n  color: #000000;\n  letter-spacing: 0;\n  font-weight: bolder;\n}\n.rolemanage .title {\n  height: 40px;\n  font-family: PingFangSC-Regular;\n  font-size: 16px;\n  color: #8b8989;\n  letter-spacing: 0;\n  line-height: 40px;\n  padding-left: 20px;\n}\n",""])},295:function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();function r(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){return function o(r,i){try{var a=n[r](i),l=a.value}catch(e){return void t(e)}if(!a.done)return Promise.resolve(l).then(function(e){o("next",e)},function(e){o("throw",e)});e(l)}("next")})}}var i=function(e){function n(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(n,Interstellar.pagesBase),o(n,[{key:"complete",value:function(){var e=this,n=this;this.menutreeConfig={config:["id"],icon:"no",bottom:void 0,itemconfig:[]};var o=this.app.userResource[ES.selctorDoc('.menu .twolink[link="rolemanage"]').parent().attr("id")];o&&o.length>0&&o.forEach(function(n){switch(n.type){case"CREATE":e.menutreeConfig.bottom={name:"创建角色"};break;case"EDIT":e.menutreeConfig.itemconfig.push({name:"修改",code:n.type});break;case"DELETE":e.menutreeConfig.itemconfig.push({name:"删除",code:n.type})}}),this.roleModal=t(2012),this.apidata={},this.permission_search(),this.renderMenu(),this.dom.find(".roleName").on("keydown",function(e){13==e.keyCode&&n.role_search(ES.selctorDoc(this).val())})}},{key:"renderMenu",value:function(){var e=this;t.e(84).then(function(){var n=t(1528);e.menutree=e.app.loadModule(n,e.dom.find(".groupArea"),e.menutreeConfig),e.role_search(""),e.menutree.event._addEvent("navFirst.choosed",function(n){console.log(n),e.dom.find(".listArea .title").html(n.name),e.role_read(n.id)}),e.menutree.event._addEvent("menutree.itemAction",function(n){switch(console.log(n),n.type){case"CREATE":case"EDIT":e.showModal(n);break;case"DELETE":e.app.alert.show({title:"",template:'<span style="font-size: 18px;font-weight: bold;">确认删除吗？</span>',sure:function(){var t=r(regeneratorRuntime.mark(function t(){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.api.role_delete({id:n.id});case 2:0==(o=t.sent).code?e.role_search(""):e.errorshow(o.msg);case 4:case"end":return t.stop()}},t,e)}));return function(){return t.apply(this,arguments)}}(),close:!0})}})}.bind(null,t)).catch(t.oe)}},{key:"showModal",value:function(){var e=r(regeneratorRuntime.mark(function e(n){var t,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.role=this.app.loadModal(this.roleModal,{adv:!0},{type:n.type,data:this.allPermission}),t=null,"EDIT"!=n.type){e.next=7;break}return e.next=5,this.api.role_read({id:n.id});case 5:0==(t=e.sent).code?this.role.renderData(t.data):Tool.errorshow(t.msg,this.app);case 7:this.role.event._addEvent("roleModal.submit",function(){var e=r(regeneratorRuntime.mark(function e(r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("CREATE"!=n.type&&r.name===t.data.name){e.next=7;break}return e.next=3,o.api.role_nameExit({name:r.name});case 3:if(401!=e.sent.code){e.next=7;break}return o.role.showError("名称已存在"),e.abrupt("return");case 7:return r.action="CREATE"==n.type?1:2,"EDIT"==n.type&&(r.id=n.id),e.next=11,o.api.role_edit(r);case 11:0==(i=e.sent).code?(o.role_search(),o.role.close()):o.errorshow(i.msg);case 13:case"end":return e.stop()}},e,o)}));return function(n){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"role_search",value:function(){var e=r(regeneratorRuntime.mark(function e(n){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.role_search({name:n});case 2:t=e.sent,this.menutree.changeMenu(t.data,"single"),this.dom.find(".treeArea .navFirst").eq(0).click();case 5:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"role_read",value:function(){var e=r(regeneratorRuntime.mark(function e(n){var t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.role_read({id:n});case 2:t=e.sent,o="",this.dom.find(".roleList").html('<li class="roleTitle">\n                <p class="roleName">权限名称</p>\n                <p class="roleContent">权限内容</p>\n            </li>'),t.data.permissionList.length&&t.data.permissionList.length>0?(t.data.permissionList.forEach(function(e){var n="";e.resourceList&&t.data.permissionList.length>0&&e.resourceList.forEach(function(e){n+='<span class="permissions" title="'+e.resourceParentName+"("+e.resourceCode.toString()+')">'+e.resourceParentName+'<label class="soft">('+e.resourceCode.toString()+") </label></span>"}),o+='<li><p class="roleName">'+e.permissionName+'</p><p class="roleContent">'+n+"</p></li>"}),this.dom.find(".roleList").append(o)):(o='<p class="noData">暂无内容</p>',this.dom.find(".roleList").html(o));case 6:case"end":return e.stop()}},e,this)}));return function(n){return e.apply(this,arguments)}}()},{key:"permission_search",value:function(){var e=r(regeneratorRuntime.mark(function e(){var n,t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.permission_search({});case 2:n=e.sent,this.allPermission={},n.data.permissionPoList.forEach(function(e){var n={0:[]};e.pageResourceList.forEach(function(e){n[e.parentId]||(n[e.parentId]=[]),0==e.parentId?n[0].push(e):n[e.parentId].push(e)}),t.allPermission[e.id]={name:e.name,data:n}});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"errorshow",value:function(e){this.app.alert.show({title:" ",msg:e,close:!1})}}]),n}();e.exports=i},776:function(e,n,t){var o=t(2016);"string"==typeof o&&(o=[[e.i,o,""]]);var r={transform:void 0};t(705)(o,r);o.locals&&(e.exports=o.locals)},777:function(e,n,t){"use strict";var o="/base/role/search",r="/base/role/nameExit",i="/base/role/read",a="/base/role/edit",l="/base/role/delete",s="/base/permission/query",c={role_search:function(e){return this.HttpRequest.POST(o,e)},role_nameExit:function(e){return this.HttpRequest.POST(r,e)},role_read:function(e){return this.HttpRequest.POST(i,e)},role_edit:function(e){return this.HttpRequest.POST(a,e)},role_delete:function(e){return this.HttpRequest.POST(l,e)},permission_search:function(e){return this.HttpRequest.POST(s,e)}};e.exports=c},778:function(e,n){e.exports='<div class=rolemanage> <div class=leftArea> <input type=text class=roleName placeholder=搜索 /> <i class="iconfont icon-sousuo"></i> <div class=groupArea></div> </div> <div class=rightArea> <div class=listArea> <p class=title></p> <ul class=roleList> <li class=roleTitle> <p class=roleName>权限名称</p> <p class=roleContent>权限内容</p> </li> </ul> </div> </div> </div> '},779:function(e,n,t){"use strict";var o=function(e){function n(e){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.apiData={page:1,pageSize:10},t.condition=[],t.tableconfig={icon:{name:{name:'<span data-i18n="pname">权限名称</span>',type:"text",w:"25%",ww:"25%",n:"40"},mobilePhone:{name:'<span data-i18n="gh">权限内容</span>',type:"text",w:"75%",ww:"75%"}},onofftype:{0:"关",1:"开"},type:"center"},t.listicon={action:{config:{dis:"inline",link:"noLink",content:[{text:"查看",key:"view"},{text:"修改",key:"edit"}]}}},t}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(n,Interstellar.modelBase),n}();e.exports=o}});