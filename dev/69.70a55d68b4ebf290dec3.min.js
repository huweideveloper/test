webpackJsonp([69],{2005:function(e,t,a){(e.exports=a(704)(!1)).push([e.i,".ytjtaskdetail {\n  background: #fff;\n}\n.ytjtaskdetail .breadcrumb {\n  padding: 40px 0 0 70px;\n  font-size: 16px;\n  margin-right: 10px;\n}\n.ytjtaskdetail .breadcrumb .lastlink {\n  color: #ccc;\n  cursor: pointer;\n}\n.ytjtaskdetail .taskdetail {\n  margin: 20px 0 20px 70px;\n}\n.ytjtaskdetail .taskdetail > span {\n  width: 40%;\n  line-height: 30px;\n}\n.ytjtaskdetail .taskdetail .export {\n  margin-left: 20px;\n}\n.ytjtaskdetail .sequencearea {\n  display: flex;\n  margin-left: 70px;\n}\n.ytjtaskdetail .sequencearea .personarea {\n  width: 160px;\n  border-right: 1px solid #e8e8e8;\n}\n.ytjtaskdetail .sequencearea .personarea .menutitle {\n  height: 60px;\n  line-height: 60px;\n}\n.ytjtaskdetail .sequencearea .personarea .left .navFirst {\n  padding-left: 20px;\n  height: 40px;\n  line-height: 40px;\n  cursor: pointer;\n}\n.ytjtaskdetail .sequencearea .personarea .left .choosedks {\n  background: #ecf3f4;\n}\n.ytjtaskdetail .sequencearea .listarea {\n  flex: 1;\n}\n.ytjtaskdetail .sequencearea .listarea .filterarea {\n  padding-left: 20px;\n}\n.ytjtaskdetail .sequencearea .listarea .filterarea input {\n  height: 32px;\n  border: 1px solid #e8e8e8;\n  border-radius: 4px;\n  margin-right: 10px;\n}\n.ytjtaskdetail .sequencearea .listarea .personinfo {\n  margin: 10px 0;\n  padding-left: 20px;\n}\n.ytjtaskdetail .sequencearea .listarea .personinfo span {\n  width: 20%;\n}\n.ytjtaskdetail .sequencearea .listarea .personinfo .viewall {\n  background: #4c9fa9;\n  color: #fff;\n  padding: 0 20px;\n  height: 40px;\n  line-height: 40px;\n}\n",""])},283:function(e,t,a){"use strict";var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}();function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function i(n,s){try{var r=t[n](s),l=r.value}catch(e){return void a(e)}if(!r.done)return Promise.resolve(l).then(function(e){i("next",e)},function(e){i("throw",e)});e(l)}("next")})}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Interstellar.pagesBase),i(t,[{key:"complete",value:function(){var e=this;this.styleModel(1),this.type=this.app.parpam.type,this.taskId=1*this.app.parpam.taskid,this.taskType=this.app.parpam.taskType,this.model._event._addEvent("taskid.change",function(){e.settaskdata()}),this.action={viewmark:{dis:"inline",link:"noLink",content:"查看标注结果"}},this.action1={viewseries:{dis:"inline",link:"noLink",content:"查看序列"}},this.render(),this.setTitle(),this.task_read(),this.dom.find(".breadcrumb .lastlink").on("click",function(){e.app.model.del("ytjtaskdetail"),e.app.changePage(1==e.taskType?"taskmanage":"backflowtask",{type:"fs"})}),this.model._event._addEvent("querylist.change",n(regeneratorRuntime.mark(function t(){var a,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.model.getData("querylist").reset,t.next=3,e.api.getuserseries(e.model.getData("querylist"));case 3:0==(i=t.sent).code?(e.dom.find('label[api="seriesEndNum"]').html(parseInt(i.data.total)-parseInt(e.doingnum)),e.setMain(i,a)):Tool.errorshow(i.msg,e.app);case 5:case"end":return t.stop()}},t,e)})))}},{key:"render",value:function(){var e=this;a.e(84).then(function(){var t=a(1528);e.menutree=e.app.loadModule(t,e.dom.find(".personarea .left"),{config:["venderName","mobile_phone","discardNum","workNum","imageNumber"]}),e.model.setData("taskid",e.taskId),e.menutree.event._addEvent("navFirst.choosed",function(t){e.doingnum=t.config.split(",")[3],e.dom.find('label[api="venderName"]').html("null"!==t.config.split(",")[0]?t.config.split(",")[0]:""),e.dom.find('label[api="username"]').html(t.config.split(",")[1]),e.dom.find('label[api="discardNum"]').html(t.config.split(",")[2]),e.dom.find('label[api="workNum"]').html(t.config.split(",")[3]),e.dom.find('label[api="imageNumber"]').html(t.config.split(",")[4]),e.model.querylist.reset=!0,e.model.querylist.page=1,e.model.querylist.userId=parseInt(t.id),e.model.querylist.serialNumber=e.dom.find('input[api="serialNumber"]').val(),e.model.setData("querylist",e.model.querylist)})}.bind(null,a)).catch(a.oe),this.dom.find(".biaozhubtn").on("click",function(){var t=e.seriesImgFileType;1===t||2===t?(e.model.querylist.reset=!0,e.app.model.set("ytjtaskdetail",e.model.querylist),e.app.changePage(e.largeFigure?"drapCanvasCheck":"markview",{taskId:e.app.parpam.taskid,projectId:e.projectId,type:"viewer_all",uid:e.model.querylist.userId,sid:1,taskType:e.taskType})):Tool.goToC(e.app,{taskId:e.taskId,userId:e.model.querylist.userId,seriesImgFileType:t,type:3,projectId:e.projectId})}),this.dom.find(".taskdetail .export").on("click",function(){var t=e.app.domain1+"v1/task/series/discard/export/?taskId="+e.taskId;Tool.downfile(t,e.app)}),this.dom.find(".sequencearea .search").on("click",function(){e.model.setData("querylist",{taskId:parseInt(e.taskId),userId:parseInt(e.dom.find(".choosedks").attr("did")),page:1,pageSize:10,reset:!0,serialNumber:e.dom.find('input[api="serialNumber"]').val()})})}},{key:"setTitle",value:function(){var e=this,t={icon:{serialNumber:{name:'<span data-name="序号">序号</span>',type:"text",w:"35%",ww:"35%"},discarded:{name:'<span data-name="是否废片">是否废片</span>',type:"text",w:"8%",ww:"8%"},status:{name:'<span data-name="标注状态">标注状态</span>',type:"text",w:"10%",ww:"10%"},imageAnnoNum:{name:'<span data-name="病灶数量">病灶数量</span>',type:"text",w:"8%",ww:"8%"},submitTime:{name:'<span data-name="提交时间">提交时间</span>',type:"text",w:"10%",ww:"10%"},auditStatus:{name:'<span data-name="审核状态">审核状态</span>',type:"text",w:"10%",ww:"10%"},annoUpdateStatus:{name:'<span data-name="标注是否更新">标注是否更新</span>',type:"text",w:"10%",ww:"10%"},annoLastUpdateTime:{name:'<span data-name="标注最后更新时间">标注最后更新时间</span>',type:"text",w:"14%",ww:"14%"}},actionulwidth:200};t.tablewidth=ES.selctorDoc(".ytjtaskdetail").box().clientWidth-471,t.type="center",t.actionicon={operation:{name:'<span data-i18n="action" data-name="操作">操作</span>',type:"action",code:"action",w:"100%",ww:"100%"}},a.e(85).then(function(){var i=a(952);e.table=e.app.loadModule(i,e.dom.find(".serieslist"),{id:"serieslist",header:t}),e.table.event._addEvent("table.action",function(t){var a=e.app.parpam.taskid;if("viewstatistical"!=t.classname)if("down"!==t.classname){e.largeFigure;var i=e.seriesImgFileType;1===i||2===i?"viewmark"==t.classname?(e.model.querylist.reset=!0,e.app.model.set("ytjtaskdetail",e.model.querylist),e.app.changePage(e.largeFigure?"drapCanvasCheck":"markview",{taskId:e.app.parpam.taskid,projectId:e.projectId,type:"viewer_admin",uid:e.model.querylist.userId,sid:t.id,taskType:e.taskType})):"viewseries"==t.classname&&(e.model.querylist.reset=!0,e.app.model.set("ytjtaskdetail",e.model.querylist),e.app.changePage(e.largeFigure?"drapCanvasCheck":"markview",{taskId:e.app.parpam.taskid,projectId:e.projectId,type:"viewer_admin",uid:e.model.querylist.userId,sid:t.id,taskType:e.taskType})):Tool.goToC(e.app,{taskId:e.taskId,userId:e.model.querylist.userId,seriesImgFileType:i,type:2,serialNumber:t.id,projectId:e.projectId})}else{var n=window.location.origin+"/aaa/v1/pdf/lung/nodules?taskId="+a+"&studyInstanceUid="+t.id+"&clearDicom=true";e.api.HttpRequest.downLoadFile(n,{key:"accessToken",val:e.app.local.get("accessToken")})}else{var s=t.id;window.open(window.location.origin+"/#!/ytjtaskstatistical/"+s+"/"+a)}}),e.table.event._addEvent("table.pagenumber",function(t){var a=e.model.getData("querylist");a.reset=!1,a.page=parseInt(t),e.table.changenum(parseInt(t)),e.model.setData("querylist",a)}),e.table.event._addEvent("table.pagesize",function(t){var a=e.model.getData("querylist");a.page=1,a.pageSize=t.num,a.reset=!0,e.model.setData("querylist",a)}),e.dom.find(".list-content").removeClass("hide")}.bind(null,a)).catch(a.oe)}},{key:"setMain",value:function(e,t){var a=this;"1"===Tool.configobjformatremark(this.app.constmap.SINGLE_CONFIG).MASK_PROPERTIES_WEB_ONOFF&&(this.action.viewstatistical={dis:"inline",link:"noLink",content:"统计结果"});var i=[];0==e.code?e.data.list.length>0?(e.data.list.forEach(function(e){var t={};if(e.id=e.serialNumber,t.id=e.id,1==e.discarded?(t.operation=a.action1,e.discarded="是"):(t.operation=a.action,e.discarded="否"),a.studyAnno&&(e.imageTotalNum=""),i.push(t),"2"==String(e.status)||"1"==String(e.status)?e.status="标注进行中":e.status="已提交",e.submitTime=e.submitTime?Tool.time(e.submitTime,"yyyy-mm-dd HH:MM"):"无","number"==typeof e.auditStatus){e.auditStatus=["待审核","","审核通过","审核未通过"][e.auditStatus]}else e.auditStatus="";e.annoUpdateStatus="boolean"==typeof e.annoUpdateStatus?e.annoUpdateStatus?"是":"否":"",e.annoLastUpdateTime=e.annoLastUpdateTime?Tool.time(e.annoLastUpdateTime,"yyyy-mm-dd HH:MM"):""}),this.table.setData(e.data.list,i)):this.table.noData():Tool.errorshow(e.msg,this.app),t&&(this.table.getTotal(e.data.pages,2,e.data.total),this.table.changenum(this.model.querylist.page,this.model.querylist.pageSize))}},{key:"settaskdata",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t,a,i,n,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:this.taskId},a=["name","projectName","startTime","endTime","algPreAnnotation","seriesTotalNum","seriesSubmittedNum","seriesDiscardNum","seriesProcessNum","discardNum","workNum","imageNumber"],e.next=4,this.api.gettask(t);case 4:0==(i=e.sent).code?(i.data.startTime=Tool.time(i.data.startTime,"yyyy-mm-dd"),i.data.endTime=Tool.time(i.data.endTime,"yyyy-mm-dd"),i.data.studyAnno?(this.studyAnno=!0,i.data.algPreAnnotation=i.data.algPreAnnotation?"算法标注（以检查号为维度）":"人工标注（以检查号为维度）"):i.data.algPreAnnotation=i.data.algPreAnnotation?"算法标注":"人工标注",i.data.seriesDiscardNum>0&&this.dom.find(".taskdetail .export").removeClass("hide"),n=i.data.crossMarkNum?i.data.crossMarkNum:1,a.forEach(function(e,t){if("seriesTotalNum"==e){var a=i.data[e]/n+"(*"+n+")";s.dom.find('label[apidata="'+e+'"]').html(a)}else s.dom.find('label[apidata="'+e+'"]').html(i.data[e])}),this.projectId=i.data.projectId,this.menutree.changeMenu(i.data.userList,"single"),this.dom.find(".treeArea .navFirst").eq(0).click(),this.app.model.get("ytjtaskdetail")?(this.model.setData("querylist",this.app.model.get("ytjtaskdetail")),this.app.model.get("ytjtaskdetail").serialNumber&&this.dom.find('.filterarea input[api="serialNumber"]').val(this.app.model.get("ytjtaskdetail").serialNumber),this.app.model.get("ytjtaskdetail").userId&&this.dom.find('.treeArea .navFirst[did="'+this.app.model.get("ytjtaskdetail").userId+'"]').click()):this.dom.find(".treeArea .navFirst").eq(0).click()):Tool.errorshow(i.msg,this.app);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"task_read",value:function(){var e=n(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.app.loading.show(),e.next=3,this.api.task_read({id:this.taskId});case 3:t=e.sent,this.app.loading.hide(),0==t.code?(this.seriesImgFileType=t.data.seriesImgFileType,this.projectId=t.data.projectId,this.largeFigure=t.data.largeFigure,t.data.isLungPdf&&(a={dis:"inline",link:"noLink",content:"下载"},this.action.down=a,this.action1.down=a),9===this.seriesImgFileType?this.dom.find(".viewall").addClass("hide"):this.dom.find(".viewall").removeClass("hide")):Tool.errorshow(t.msg,this.app);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();e.exports=s},764:function(e,t,a){var i=a(2005);"string"==typeof i&&(i=[[e.i,i,""]]);var n={transform:void 0};a(705)(i,n);i.locals&&(e.exports=i.locals)},765:function(e,t,a){"use strict";var i="/task/user/list",n="/task/user/series/search",s="/task/read",r={gettask:function(e){return this.HttpRequest.POST(i,e)},getuserseries:function(e){return this.HttpRequest.POST(n,e)},task_read:function(e){return this.HttpRequest.POST(s,e)}};e.exports=r},766:function(e,t){e.exports='<div class=ytjtaskdetail> <div class=breadcrumb> <span class=lastlink link=taskmanage>任务列表</span>> <span class=nowlink>查阅已提交任务</span> </div> <div class=taskdetail> <span>任务名称：<label apidata=name></label></span> <span>所属项目：<label apidata=projectName></label></span> <span>任务开始时间：<label apidata=startTime></label></span> <span>任务结束时间：<label apidata=endTime></label></span> <span>任务类型：<label apidata=algPreAnnotation></label></span> <span>序号总量（*交叉次数）：<label apidata=seriesTotalNum></label></span> <span>已提交序号数量（含交叉次数）：<label apidata=seriesSubmittedNum></label></span> <span>废片数量（不含交叉次数）：<label apidata=seriesDiscardNum></label><a class="fillBtn export hide">废片信息导出</a></span> <span>标注中序号数量：<label apidata=seriesProcessNum></label></span> </div> <div class=sequencearea> <div class=personarea> <span class=menutitle>提交人姓名</span> <div class=left></div> </div> <div class=listarea> <div class=filterarea> 序号：<input type=text api=serialNumber /> <a class="strokeBtn search">查询</a> </div> <div class=personinfo> <span class="">提交人用户名:<label api=username></label></span> <span class="" style=width:16%>所属单位:<label api=venderName></label></span> <span class="" style=width:12%>已提交序号数量:<label api=seriesEndNum></label></span> <span class="" style=width:10%>废片数量:<label api=discardNum></label></span> <span class="" style=width:10%>正在执行中:<label api=workNum></label></span> <span class="" style=width:10%>病灶数量:<label api=imageNumber></label></span> <a class="viewall biaozhubtn hide">查看所有标注结果</a> </div> <div class=scrollright> <div class=serieslist></div> </div> </div> </div> </div> '},767:function(e,t,a){"use strict";var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.taskid={},a.userlist={},a.querylist={page:1,pageSize:10,taskId:parseInt(a.app.parpam.taskid),reset:!0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Interstellar.modelBase),t}();e.exports=i}});